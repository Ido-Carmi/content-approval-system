{% extends "base.html" %}
{% block title %}×¢×¨×›×™× ×©× ×“×—×•{% endblock %}
{% block page_title %}<div class="text-center">ğŸ—‘ï¸ ×¢×¨×›×™× ×©× ×“×—×•</div>{% endblock %}

{% block content %}
<style>
/* Masonry layout - 4 columns like review page */
#denied-grid {
    column-count: 4;
    column-gap: 1rem;
}

@media (max-width: 1400px) {
    #denied-grid { column-count: 3; }
}

@media (max-width: 992px) {
    #denied-grid { column-count: 2; }
}

@media (max-width: 576px) {
    #denied-grid { column-count: 1; }
}

.denied-card {
    break-inside: avoid;
    margin-bottom: 1rem;
    display: inline-block;
    width: 100%;
}

/* Bigger buttons like review page */
.denied-card .btn {
    font-size: 1.1rem;
    padding: 0.75rem;
    font-weight: 600;
}

/* HTMX swap animations - make them visible! */
.denied-card.htmx-swapping {
    opacity: 0;
    transform: translateY(-30px);
    transition: opacity 500ms ease-out, transform 500ms ease-out;
}

.denied-card {
    opacity: 1;
    transform: translateY(0);
    transition: opacity 500ms ease-in, transform 500ms ease-in;
}
</style>

<div class="alert alert-warning mb-3 py-2">
    <strong>{{ entries|length if entries else 0 }}</strong> ×¢×¨×›×™× × ×“×—×• (× ××—×§×™× ××•×˜×•××˜×™×ª ×œ××—×¨ 24 ×©×¢×•×ª)
</div>

{% if not entries %}
<div class="alert alert-info text-center py-5">
    <h4>××™×Ÿ ×¢×¨×›×™× × ×“×—×™×</h4>
</div>
{% else %}
<div id="denied-grid">
    {% for entry in entries %}
    <div class="denied-card" id="denied-{{ entry.id }}">
        <div class="card">
            <div class="card-header bg-warning py-2">
                <div class="d-flex justify-content-between align-items-center">
                    <small><i class="bi bi-calendar3"></i> {{ entry.timestamp }}</small>
                    <span class="badge bg-dark"><i class="bi bi-clock"></i> {{ entry.time_remaining }}</span>
                </div>
            </div>
            <div class="card-body py-2">
                <textarea class="form-control mb-2" 
                          rows="1"
                          readonly
                          oninput="this.style.height='';this.style.height=this.scrollHeight+'px'"
                          style="overflow-y: hidden; resize: none;">{{entry.text}}</textarea>
                <button type="button" 
                        class="btn btn-success w-100"
                        hx-post="{{ url_for('restore_denied', entry_id=entry.id) }}"
                        hx-target="#denied-{{ entry.id }}"
                        hx-swap="outerHTML swap:400ms settle:500ms">
                    <i class="bi bi-arrow-counterclockwise"></i> ×”×—×–×¨
                </button>
            </div>
        </div>
    </div>
    {% endfor %}
</div>

<script>
// Auto-resize all textareas on page load
document.addEventListener('DOMContentLoaded', function() {
    document.querySelectorAll('textarea').forEach(function(textarea) {
        textarea.style.height = '';
        textarea.style.height = textarea.scrollHeight + 'px';
    });
});
</script>
{% endif %}
{% endblock %}
